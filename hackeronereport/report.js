(function(){var time=prompt("指定月份，格式2020-01");var csrftoken=document.getElementsByName("csrf-token")[0].content;var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var json=this.responseText;displaySearchResults(json)}};xhr.open("POST","/bugs.json?subject=user&report_id=0&view=custom&substates%5B%5D=new&substates%5B%5D=needs-more-info&substates%5B%5D=triaged&substates%5B%5D=pre-submission&substates%5B%5D=duplicate&substates%5B%5D=informative&substates%5B%5D=not-applicable&substates%5B%5D=resolved&substates%5B%5D=spam&reported_to_team=&text_query=&program_states%5B%5D=2&program_states%5B%5D=3&program_states%5B%5D=4&program_states%5B%5D=5&sort_type=latest_activity&sort_direction=descending&limit=1000&page=1");xhr.setRequestHeader("X-CSRF-Token",csrftoken);xhr.send();function displaySearchResults(json){var jsondata=JSON.parse(json);var report=new Array();var rating=new Array();var content='<link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"crossorigin="anonymous"><script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"crossorigin="anonymous"><\/script><div class="panel panel-default"><div class="panel-heading"></div><div class="panel-body"><div class="alert alert-success"role="alert"><CENTER>'+time+' BUGBOUNTY 报告统计</CENTER></div></div><table class="table"><thead><tr><th>Report ID</th><th>漏洞名称</th><th>漏洞等级</th><th>漏洞状态</th><th>提交时间</th></tr></thead><tbody><tr>';for(i=0,a=0;i<jsondata["bugs"].length;i++){if(jsondata["bugs"][i].created_at.slice(0,7)==time){content=content+"<th scope='row'>"+jsondata["bugs"][i].id+"</th><td>"+jsondata["bugs"][i].title+"</td><td>"+jsondata["bugs"][i].severity_rating+"</td><td>"+jsondata["bugs"][i].readable_substate+"</td><td>"+jsondata["bugs"][i].created_at.slice(0,10)+"</td></tr>";a++;report.push(jsondata["bugs"][i].id);rating.push(jsondata["bugs"][i].severity_rating)}}for(m=0,b=0,len=report.length;b<len;b++){var req=new XMLHttpRequest();req.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var jso=JSON.parse(this.responseText);if(!(jso["bounty_amount"]==undefined)){m=m+parseInt(jso["bounty_amount"])}}};req.open("GET","/reports/"+report[b]+".json",false);req.send()}var _res=[];rating.sort();for(var i=0;i<rating.length;){var count=0;for(var j=i;j<rating.length;j++){if(rating[i]==rating[j]){count++}}_res.push([rating[i],count]);i+=count}var _newArr=[];for(var i=0;i<_res.length;i++){_newArr.push(_res[i][0]+"的数量为"+_res[i][1]+"个")}content=content+'</tbody></table></div><div class="alert alert-info" role="alert"><center>'+"在这段时间，您一共提交了"+a+"份报告。共获得$"+m+"。漏洞情况如下:<br>"+_newArr+"</center></div>";exportRaw("report-"+time+".html",content);function fakeClick(obj){var ev=document.createEvent("MouseEvents");ev.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);obj.dispatchEvent(ev)}function exportRaw(name,data){var urlObject=window.URL||window.webkitURL||window;var export_blob=new Blob([data]);var save_link=document.createElementNS("http://www.w3.org/1999/xhtml","a");save_link.href=urlObject.createObjectURL(export_blob);save_link.download=name;fakeClick(save_link)}}})();
